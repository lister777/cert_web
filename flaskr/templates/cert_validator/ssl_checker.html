{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}SSL-Checker{% endblock %}</h1>
{% endblock %}

{% block content %}
  <form method="post">
    <label for="url">URL</label>
    <input name="url" id="url">
    <input type="submit" value="Check SSL">
  </form>
  
 {% for cert in certs %}
      <article class="cert">
              <div>
                  <div>Common Name: {{ cert[0].get_subject().commonName }}</div>
                  <div>Serial Number: {{ cert[0].get_serial_number() }}</div>
                  <div>Signature Algorithm: {{ cert[0].get_signature_algorithm().decode('utf-8') }}</div>
                  <div>Issuer: {{ cert[0].get_issuer() }}</div>
                  <div>Subject: {{ cert[0].get_subject() }}</div>
                  <div>Valid from {{ time_convert(cert[0].get_notBefore()) }} to {{ time_convert(cert[0].get_notAfter()) }} </div>
                  <div>Certificate:</div>
                  <div>{{ cert[1] }}</div>
              </div>
          </header>
      {% if not loop.last %}
          <hr>
      {% endif %}
  {% endfor %}
{% endblock %}